[
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: Which sector has the minimum exposure?\nGenerate SQL:",
    "output": "SELECT counterparty_sector, SUM(CAST(mpe AS DECIMAL(15,2))) as total_exposure FROM counterparty_new WHERE counterparty_sector IS NOT NULL GROUP BY counterparty_sector ORDER BY total_exposure ASC LIMIT 1;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: Which sector has the lowest exposure?\nGenerate SQL:",
    "output": "SELECT counterparty_sector, SUM(CAST(mpe AS DECIMAL(15,2))) as total_exposure FROM counterparty_new WHERE counterparty_sector IS NOT NULL GROUP BY counterparty_sector ORDER BY total_exposure ASC LIMIT 1;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: Which are the top 5 counterparties by MPE value?\nGenerate SQL:",
    "output": "SELECT counterparty_name, counterparty_id, CAST(mpe AS DECIMAL(15,2)) as mpe_value FROM counterparty_new ORDER BY CAST(mpe AS DECIMAL(15,2)) DESC LIMIT 5;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: Which counterparties have the highest total notional exposure?\nGenerate SQL:",
    "output": "SELECT cp.counterparty_name, SUM(CAST(t.notional_usd AS DECIMAL(15,2))) as total_notional FROM counterparty_new cp JOIN trade_new t ON cp.counterparty_id = t.reporting_counterparty_id GROUP BY cp.counterparty_id, cp.counterparty_name ORDER BY total_notional DESC LIMIT 20;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: How many trades exist per counterparty?\nGenerate SQL:",
    "output": "SELECT cp.counterparty_name, COUNT(t.id) as trade_count FROM counterparty_new cp LEFT JOIN trade_new t ON cp.counterparty_id = t.reporting_counterparty_id GROUP BY cp.counterparty_id, cp.counterparty_name ORDER BY trade_count DESC;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: Which counterparties have breached their MPE limits?\nGenerate SQL:",
    "output": "SELECT counterparty_name, CAST(mpe AS DECIMAL(15,2)) as current_mpe, CAST(mpe_limit AS DECIMAL(15,2)) as mpe_limit FROM counterparty_new WHERE CAST(mpe AS DECIMAL(15,2)) > CAST(mpe_limit AS DECIMAL(15,2)) ORDER BY current_mpe DESC;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: What is the distribution of counterparties by rating?\nGenerate SQL:",
    "output": "SELECT internal_rating, COUNT(*) as count, SUM(CAST(mpe AS DECIMAL(15,2))) as total_exposure FROM counterparty_new WHERE internal_rating IS NOT NULL GROUP BY internal_rating ORDER BY total_exposure DESC;"
  },
  {
    "input": "Database Schema:\n\nTable: concentration_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(8))\n  - reporting_group (VARCHAR(7))\n  - concentration_group (VARCHAR(7))\n  - concentration_value (VARCHAR(9))\n  - mpe (VARCHAR(9))\n  - counterparty_count (VARCHAR(1))\nForeign Keys:\n  - ['entity'] -> counterparty_new.['entity']\n\nTable: counterparty_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(19))\n  - entity (VARCHAR(6))\n  - reporting_group (VARCHAR(24))\n  - counterparty_id (VARCHAR(6))\n  - counterparty_name (VARCHAR(13))\n  - ccp_name (VARCHAR(5))\n  - fcm_name (VARCHAR(5))\n  - ccp_flag (VARCHAR(3))\n  - internal_rating (VARCHAR(2))\n  - product_type (VARCHAR(11))\n  - _of_ir_trades (VARCHAR(1))\n  - _of_fx_trades (VARCHAR(1))\n  - _of_cds_trades (VARCHAR(1))\n  - _of_cmdty_trades (VARCHAR(1))\n  - _of_eq_trades (VARCHAR(1))\n  - _of_repo_trades (VARCHAR(1))\n  - _of_rev_repo_trades (VARCHAR(1))\n  - _of_options (VARCHAR(2))\n  - _of_future (VARCHAR(1))\n  - closeout_netting_flag (VARCHAR(3))\n  - batch_mtm (VARCHAR(11))\n  - ce (VARCHAR(5))\n  - ce_im_vm (VARCHAR(6))\n  - mpe (VARCHAR(8))\n  - mpe_limit (VARCHAR(7))\n  - epe (VARCHAR(5))\n  - epe_limit (VARCHAR(6))\n  - repo_notional (VARCHAR(5))\n  - repo_notional_limit (VARCHAR(6))\n  - rev_repo_notional (VARCHAR(5))\n  - rev_repo_notional_limit (VARCHAR(5))\n  - stressed_mpe_scenario1 (VARCHAR(4))\n  - stressed_mpe_scenario2 (VARCHAR(4))\n  - stressed_mpe_scenario3 (VARCHAR(3))\n  - stressed_mpe_scenario4 (VARCHAR(3))\n  - stressed_mpe_scenario5 (VARCHAR(3))\n  - stressed_mpe_scenario6 (VARCHAR(3))\n  - stressed_mpe_scenario7 (VARCHAR(5))\n  - stressed_mpe_scenario8 (VARCHAR(2))\n  - stressed_mpe_scenario9 (VARCHAR(3))\n  - stressed_mpe_scenario10 (VARCHAR(4))\n  - stressed_epe_scenario10 (VARCHAR(5))\n  - stressed_epe_scenario1 (VARCHAR(5))\n  - stressed_epe_scenario2 (VARCHAR(4))\n  - stressed_epe_scenario3 (VARCHAR(4))\n  - stressed_epe_scenario4 (VARCHAR(4))\n  - stressed_epe_scenario5 (VARCHAR(4))\n  - stressed_epe_scenario6 (VARCHAR(3))\n  - stressed_epe_scenario7 (VARCHAR(4))\n  - stressed_epe_scenario8 (VARCHAR(5))\n  - stressed_epe_scenario9 (VARCHAR(5))\n  - stressed_ce_scenario10 (VARCHAR(3))\n  - stressed_ce_scenario1 (VARCHAR(3))\n  - stressed_ce_scenario2 (VARCHAR(4))\n  - stressed_ce_scenario3 (VARCHAR(4))\n  - stressed_ce_scenario4 (VARCHAR(4))\n  - stressed_ce_scenario5 (VARCHAR(4))\n  - stressed_ce_scenario6 (VARCHAR(3))\n  - stressed_ce_scenario7 (VARCHAR(4))\n  - stressed_ce_scenario8 (VARCHAR(4))\n  - stressed_ce_scenario9 (VARCHAR(7))\n  - _of_new_trades (VARCHAR(4))\n  - _of_expired_trades (VARCHAR(5))\n  - new_counterparty_flag (VARCHAR(3))\n  - active_mpe_limit (VARCHAR(9))\n  - active_epe_limit (VARCHAR(6))\n  - facility_id (VARCHAR(8))\n  - buffer (VARCHAR(3))\n  - internal_entity (VARCHAR(6))\n  - revolver_status (VARCHAR(8))\n  - tenor_month (VARCHAR(2))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit (VARCHAR(6))\n  - counterparty_country (VARCHAR(2))\n  - counterparty_sector (VARCHAR(7))\n  - ultimate_parent_sun_id (VARCHAR(6))\n  - ultimate_parent_name (VARCHAR(8))\n  - ultimate_parent_country (VARCHAR(2))\n  - ultimate_parent_sector (VARCHAR(7))\n  - dv01 (VARCHAR(9))\n  - dv01_by_ir_curve1 (VARCHAR(4))\n  - dv01_by_ir_curve2 (VARCHAR(5))\n  - dv01_by_ir_curve3 (VARCHAR(4))\n  - dv01_by_ir_curve4 (VARCHAR(3))\n  - dv01_by_ir_curve5 (VARCHAR(3))\n  - dv01_by_ir_curve6 (VARCHAR(4))\n  - fx01 (VARCHAR(3))\n  - fx01_by_ir_curve1 (VARCHAR(5))\n  - fx01_by_ir_curve2 (VARCHAR(4))\n  - fx01_by_ir_curve3 (VARCHAR(3))\n  - fx01_by_ir_curve4 (VARCHAR(4))\n  - fx01_by_ir_curve5 (VARCHAR(4))\n  - vega (VARCHAR(3))\n  - internal_entities (VARCHAR(11))\n  - _of_new_trades_monthly (VARCHAR(2))\n  - _of_expired_trades_monthly (VARCHAR(2))\n  - base_mtm (VARCHAR(4))\n  - sb_notional (VARCHAR(4))\n  - sl_notional (VARCHAR(4))\n  - sb_notional_limit (VARCHAR(4))\n  - sl_notional_limit (VARCHAR(4))\n  - notional (VARCHAR(5))\n  - agent_sun_id (VARCHAR(5))\n  - trader_books (VARCHAR(5))\n  - counterparty_industry (VARCHAR(7))\n  - sb_credit_limit (VARCHAR(4))\n  - sl_credit_limit (VARCHAR(4))\n  - non_ig_notional (VARCHAR(4))\n  - counterparty_type (VARCHAR(10))\n  - stressed_mtm_scenario1 (VARCHAR(5))\n  - stressed_mtm_scenario2 (VARCHAR(5))\n  - stressed_mtm_scenario3 (VARCHAR(5))\n  - stressed_mtm_scenario4 (VARCHAR(5))\n  - stressed_mtm_scenario5 (VARCHAR(5))\n  - stressed_mtm_scenario6 (VARCHAR(5))\n  - stressed_mtm_scenario7 (VARCHAR(5))\n  - stressed_mtm_scenario8 (VARCHAR(5))\n  - stressed_mtm_scenario9 (VARCHAR(5))\n  - stressed_mtm_scenario10 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario1 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario2 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario3 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario4 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario5 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario6 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario7 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario8 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario9 (VARCHAR(5))\n  - stressed_ce_im_vm_scenario10 (VARCHAR(5))\n\nTable: trade_new\nColumns:\n  - id (BIGINT)\n  - column_name (VARCHAR(13))\n  - as_of_date (VARCHAR(9))\n  - trade_id (VARCHAR(6))\n  - entity (VARCHAR(8))\n  - legal_entity (VARCHAR(17))\n  - legal_doc_id (VARCHAR(10))\n  - reporting_counterparty_id (VARCHAR(6))\n  - reporting_counterparty_name (VARCHAR(14))\n  - facility_id (VARCHAR(7))\n  - trade_category (VARCHAR(5))\n  - asset_class (VARCHAR(25))\n  - ccp_flag (VARCHAR(3))\n  - product_type (VARCHAR(11))\n  - trade_date (VARCHAR(10))\n  - maturity_date (VARCHAR(10))\n  - maturity_bucket (VARCHAR(12))\n  - currency (VARCHAR(3))\n  - notional (VARCHAR(5))\n  - notional_usd (VARCHAR(6))\n  - official_mtm (VARCHAR(7))\n  - batch_mtm (VARCHAR(7))\n  - msa_id (VARCHAR(6))\n  - batch_mtm_unfloored (VARCHAR(8))\n  - start_date (VARCHAR(10))\n  - settlement_currency (VARCHAR(3))\n  - settlement_amount (VARCHAR(5))\n  - settlement_amount_usd (VARCHAR(5))\n  - tenor_month (VARCHAR(2))\n  - mpe_limit (VARCHAR(5))\n  - revolver_single_line (VARCHAR(8))\n  - settlement_limit_amount (VARCHAR(4))\n  - break_date (VARCHAR(10))\n  - csa_id (VARCHAR(6))\n  - pay_leg_currency (VARCHAR(3))\n  - pay_leg_notional (VARCHAR(6))\n  - rec_leg_currency (VARCHAR(3))\n  - rec_leg_notional (VARCHAR(6))\n  - rating_group (VARCHAR(8))\n  - collateral_usd (VARCHAR(8))\nForeign Keys:\n  - ['reporting_counterparty_id'] -> counterparty_new.['counterparty_id']\n\nImportant Rules:\n- Use counterparty_sector from counterparty_new table for sector queries\n- Use CAST(mpe AS DECIMAL(15,2)) for MPE calculations\n- Join counterparty_new and trade_new on counterparty_id = reporting_counterparty_id\n- Always use proper table aliases (cp for counterparty_new, t for trade_new)\n\n\nQuestion: What is the average trade notional exposure by sector?\nGenerate SQL:",
    "output": "SELECT cp.counterparty_sector, AVG(CAST(t.notional_usd AS DECIMAL(15,2))) as avg_notional FROM trade_new t JOIN counterparty_new cp ON t.reporting_counterparty_id = cp.counterparty_id WHERE cp.counterparty_sector IS NOT NULL GROUP BY cp.counterparty_sector ORDER BY avg_notional DESC;"
  }
]